<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Static Open Graph images | Sahithyan</title>
    <meta
      name="description"
      content="I added statically-generated Open Graph images to my posts; and how I optimized them."
    />

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link
      rel="alternate"
      href="https://sahithyandev.github.io/feed.xml"
      type="application/rss+xml"
      title="RSS feed"
    />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@sahithyandev" />

    <meta property="og:type" content="website" />
    <meta
      property="og:description"
      content="I added statically-generated Open Graph images to my posts; and how I optimized them."
    />
    <meta property="og:title" content="Static Open Graph images | Sahithyan" />
    <meta
      property="og:url"
      content="sahithyandev.github.io/post/open-graph-images"
    />
    <meta property="og:site_name" content="Sahithyan" />
    <meta
      property="og:image"
      content="https://sahithyandev.github.io/og-images/open-graph-images.png"
    />
    <meta
      property="og:image:alt"
      content="I added statically-generated Open Graph images to my posts; and how I optimized them."
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="" />

    <link
      rel="preload"
      as="style"
      onload="this.onload=null; this.rel='stylesheet'"
      class="google-fonts-link"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&amp;display=swap"
    />

    <noscript>
      <link class="google-fonts-link" rel="stylesheet" type="text/css" />
    </noscript>

    <script
      data-host="https://microanalytics.io"
      data-dnt="false"
      src="https://microanalytics.io/js/script.js"
      id="ZwSg9rf6GA"
      async=""
      defer=""
    ></script>

    <link rel="stylesheet" href="/global.css" />

    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("/service-worker.js")
          .catch((error) => {
            console.error("Error while initializing service worker", error);
          });
      }
    </script>

    <link rel="stylesheet" href="/route-post.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"
      crossorigin="anonymous"
      integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/prismjs@1.29.0/themes/prism-tomorrow.min.css"
    />
  </head>

  <body>
    <div id="nav-bar">
      <nav>
        <a href="/" class="nav--logo" data-is-internal="">SAHTIHYAN</a
        ><input type="checkbox" id="menu-toggle" /><label
          for="menu-toggle"
          class="hamburger-icon"
        ></label>
        <ul>
          <li>
            <a href="/tidbits" class="nav--link" data-is-internal="">Tidbits</a>
          </li>
          <li>
            <a href="/projects" class="nav--link" data-is-internal=""
              >Projects</a
            >
          </li>
          <li>
            <a href="/posts" class="nav--link" data-is-internal="">Posts</a>
          </li>
          <li>
            <a href="/about" class="nav--link" data-is-internal="">About</a>
          </li>
        </ul>
      </nav>
    </div>
    <div id="root">
      <main>
        <h1 class="post-title">Static Open Graph images</h1>
        <div class="post-meta">
          <span class="post-meta--release-date">20 November 2022</span
          ><span class="post-meta--reading-time">5 min read</span>
          <div class="tags-container"><span class="tag">experience</span></div>
        </div>
        <article>
          <section class="toc-container">
            <h3>Table Of Contents</h3>
            <ol>
              <li>
                <a
                  href="/post/open-graph-images#a-small-intro"
                  data-is-internal=""
                  class="styled-link"
                  >A small intro</a
                >
              </li>
              <li>
                <a
                  href="/post/open-graph-images#my-initial-approach"
                  data-is-internal=""
                  class="styled-link"
                  >My initial approach</a
                >
              </li>
              <li>
                <a
                  href="/post/open-graph-images#using-puppeteer"
                  data-is-internal=""
                  class="styled-link"
                  >Using Puppeteer</a
                >
              </li>
              <li>
                <a
                  href="/post/open-graph-images#vercel's-solution"
                  data-is-internal=""
                  class="styled-link"
                  >Vercel's solution</a
                >
              </li>
              <li>
                <a
                  href="/post/open-graph-images#the-one-issue-with-vercel's-solution"
                  data-is-internal=""
                  class="styled-link"
                  >The one issue with Vercel's solution</a
                >
              </li>
              <li>
                <a
                  href="/post/open-graph-images#current-approach"
                  data-is-internal=""
                  class="styled-link"
                  >Current approach</a
                >
              </li>
            </ol>
          </section>
          <h2 id="a-small-intro" class="linkable-head">
            <a
              href="/post/open-graph-images#a-small-intro"
              class="hashtag"
              data-is-internal=""
              >#</a
            ><span>A small intro</span>
          </h2>
          <p>
            When we share a link to a webpage on Facebook or Twitter or any
            other social media platform, we get a preview card. Like this one,
            for example, from Twitter.
          </p>
          <img
            alt="Preview Card Example"
            src="/post__images/the-og-package/preview-card-example.png"
            class="block"
            width="525"
            height="376"
          />
          <p>
            There's some information about the link it's referring to, such as
            the title. Each information mentioned on the card, is specified
            using a set of meta tags. Specifically, these:
          </p>
          <pre
            class="language-html"
          ><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>
    <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>og:description<span class="token punctuation">"</span></span>
    <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>How much time would you need to check if a given number is divisible by 2 â€“15 without a computer? Well, for the first few numbers, you would be so fast. But you will get stuck at 7 or 13 right? Don<span class="token punctuation">'</span>t worry. After reading this article, you won<span class="token punctuation">'</span>t. Give it a try.<span class="token punctuation">"</span></span>
<span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>
    <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>og:title<span class="token punctuation">"</span></span>
    <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Divisibility Rules - An Explanation | Sahithyan<span class="token punctuation">"</span></span>
<span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>og:url<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sahithyandev.github.io<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>
    <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>og:image<span class="token punctuation">"</span></span>
    <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://sahithyandev.github.io/og-images/divisibility-rules.png<span class="token punctuation">"</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre>
          <p>
            These (the ones with <code>property="og:..."</code>) are the Open
            Graph meta tags. These meta tags define meta data a social graph
            would find useful, such as, the language used in the website. You
            can learn more about these tags in the official website of
            <a
              href="https://ogp.me"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >Open Graph Protocol</a
            >.
          </p>
          <p>
            Among all the OG tags, I think <em>og:image</em> is an important
            one. We can define what image should be shown in the preview card
            (You can see how, in the above code snippet). Usually, links with an
            OG image defined, drive more clicks compared to the ones that don't.
            They are like a free advertising space for us. Also, it reduces time
            took by the viewers to understand what's this link is pointing to.
          </p>
          <p>
            In this post, I want to talk about how I managed to add OG images
            for the posts and other pages on this website.
          </p>
          <h2 id="my-initial-approach" class="linkable-head">
            <a
              href="/post/open-graph-images#my-initial-approach"
              class="hashtag"
              data-is-internal=""
              >#</a
            ><span>My initial approach</span>
          </h2>
          <p>
            Initially I created a blank image with my face, and used it as the
            OG image for all the pages.
          </p>
          <img
            alt="The default OG image"
            src="/og-images/base.png"
            class="block"
            width="1200"
            height="630"
          />
          <p>
            Yeah, I know, it's not that nice looking and I shouldn't be using
            the same one for all the pages. But something is better than
            nothing. Now the viewers have something to see now.
          </p>
          <h2 id="using-puppeteer" class="linkable-head">
            <a
              href="/post/open-graph-images#using-puppeteer"
              class="hashtag"
              data-is-internal=""
              >#</a
            ><span>Using Puppeteer</span>
          </h2>
          <p>
            After my initial solution failed to fully solve the issue, I started
            searching for alternate approaches and I stumbled upon
            <a
              href="https://github.blog/2021-06-22-framework-building-open-graph-images/"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >GitHub's blog post on building Open Graph Images</a
            >. I thought it would be great to do the same for my blog â€”or to at
            least give it a tryâ€”. So I followed their approach, and used
            Puppeteer to generate screenshots of a HTML page at build time. This
            allowed me to generate visually appealing OG images specific to each
            post.
          </p>
          <p>Here is an example:</p>
          <img
            alt="OG image of Divisibility Rules"
            src="/og-images/divisibility-rules.png"
            width="1200"
            height="630"
            class="block"
          />
          <p>
            It's obviously so much better than using a fairly blank image. Now,
            the viewers will know about the post at the first sight.
          </p>
          <p>
            There is one trade-off though: long build times.Puppeteer is a tool
            that uses a headless version of Chrome. Its resource-intensive
            nature makes it time-consuming to use.<br />
            On top of that, I was already using Puppeteer to prerender the pages
            at build time. This means, I am now running two separate Puppeteer
            instances(!) on each build. This would have increased the time by at
            least 30s; believe me, that's too long.
          </p>
          <p>
            I was ignoring this issue because I felt like there's no
            <em>simple</em> solutions for this issue. Thankfully,
            <a
              href="https://vercel.com"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >Vercel</a
            >
            had one.
          </p>
          <h2 id="vercel's-solution" class="linkable-head">
            <a
              href="/post/open-graph-images#vercel's-solution"
              class="hashtag"
              data-is-internal=""
              >#</a
            ><span>Vercel's solution</span>
          </h2>
          <p>
            About a month ago, Vercel announced
            <a
              href="https://vercel.com/blog/introducing-vercel-og-image-generation-fast-dynamic-social-card-images"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >OG Image Generation on Edge network</a
            >. This can be achieved using the
            <strong>@vercel/og</strong> library, which allows the generation of
            OG images from HTML/CSS on API routes, on-the-fly. Instead of using
            Puppeteer, this library utilizes
            <a
              href="https://github.com/vercel/satori#readme"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >Satori</a
            >
            â€” a library to convert HTML/CSS to SVG â€” and
            <a
              href="https://github.com/RazrFalcon/resvg#readme"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >Resvg</a
            >
            â€” a library to convert SVG to PNG â€”. More information can be found
            in
            <a
              href="https://vercel.com/docs/concepts/functions/edge-functions/og-image-generation"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >@vercel/og - Vercel's Docs</a
            >.
          </p>
          <p>
            In their announcement, they also mentioned that they saw
            <strong>5x performance improvement</strong> with @vercel/og compared
            to the Puppeteer-based solution. It mostly took less than a second.
            That's so amazing. However...
          </p>
          <h2 id="the-one-issue-with-vercel's-solution" class="linkable-head">
            <a
              href="/post/open-graph-images#the-one-issue-with-vercel's-solution"
              class="hashtag"
              data-is-internal=""
              >#</a
            ><span>The one issue with Vercel's solution</span>
          </h2>
          <p>
            <strong>@vercel/og doesn't support the Node.js runtime</strong>;
            only the Edge Runtime.
          </p>
          <img
            alt="Default Node.js runtime is not supported by @vercel/og"
            src="/post__images/the-og-package/vercel-og-support.png"
            class="block"
            width="632"
            height="156"
          />
          <p>
            They mentioned "Node.js runtime will not work". Does that mean it
            may will, in the future? I have no idea.
          </p>
          <p>
            But I wanted to use it in build time to generate the images. I
            looked for an alternative that builds on top
            <a
              href="https://github.com/vercel/satori#readme"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >Satori</a
            >
            (core library of @vercel/og) and supports Node.js. I couldn't find
            anything. So, I built one using the core libraries @vercel/og uses.
          </p>
          <p>
            So, if you are someone looking to run @vercel/og locally, you can
            use
            <a
              href="https://github.com/sahithyandev/og"
              target="_blank"
              rel="noopener noreferrer"
              class="styled-link"
              >@sahithyan/og</a
            >. ðŸ˜€
          </p>
          <h2 id="current-approach" class="linkable-head">
            <a
              href="/post/open-graph-images#current-approach"
              class="hashtag"
              data-is-internal=""
              >#</a
            ><span>Current approach</span>
          </h2>
          <p>Currently, I am using @sahithyan/og to generate the OG images.</p>
          <p>
            As my website already takes a lot of time to build, I have set the
            script up to run on every commit, instead of on every build. It's
            done using husky and lint-staged. And now, OG images will be created
            only for the posts that are being committed locally.<br />
            Other pages are still using the default one I initially used,
            though.
          </p>
        </article>
      </main>
      <div class="post-share-section">
        <div>
          <a
            href="https://twitter.com/search?q=https://sahithyandev.github.io/post/open-graph-images"
            target="_blank"
            rel="noopener noreferrer"
            class="styled-link"
            >Discuss On Twitter</a
          >
        </div>
        <div>
          <span class="share-span">Share this article on</span
          ><a
            href="https://www.twitter.com/share?text=Static%20Open%20Graph%20images%20by%20@sahithyandev&amp;url=https://sahithyandev.github.io/post/open-graph-images%7D"
            title="Twitter"
            target="_blank"
            rel="noopener noreferrer"
            class=" "
            ><svg
              class="icon icon-tabler icon-tabler-brand-twitter"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              stroke-width="2"
              stroke="currentColor"
              fill="none"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <path
                d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"
              ></path></svg
          ></a>
        </div>
      </div>
    </div>
    <footer>Â© Sahithyan 2023</footer>
  </body>
</html>
